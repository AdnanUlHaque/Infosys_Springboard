#ex63
SELECT P.PRODID, P.CATEGORY, P.PDESC, P.PRICE FROM PRODUCT P WHERE PRICE = (SELECT MAX(PRICE) FROM PRODUCT WHERE CATEGORY=P.CATEGORY);


#ex64
SELECT SNAME FROM SALESMAN S WHERE NOT EXISTS(SELECT SID FROM SALE S1 WHERE S1.SID=S.SID)


#ex65
SELECT SNAME FROM SALESMAN S WHERE EXISTS (SELECT * FROM SALE S1 WHERE S.SID=S1.SID AND TO_CHAR(S1.SLDATE, 'MM-YY')='06-15')


#ex66
SELECT sm.Sid,sm.Sname,sm.location
FROM
Saledetail sd INNER JOIN Product p
ON p.prodid = sd.prodid
INNER JOIN Sale s
ON sd.Saleid = s.Saleid
INNER JOIN Salesman sm
ON s.Sid = sm.sid
GROUP BY sm.Sid,sm.Sname,sm.Location
HAVING SUM(sd.Quantity*p.price*(100-p.Discount)/100) >
(SELECT 
AVG(SUM(sd.Quantity*p.price*(100-p.Discount)/100))
FROM Saledetail sd INNER JOIN Product p
ON p.prodid = sd.prodid
INNER JOIN Sale s
ON sd.Saleid = s.Saleid
INNER JOIN Salesman sm1
ON s.Sid = sm1.sid 
WHERE sm1.location = sm.location
GROUP BY sm1.location,sm1.sid);


#colass93
SELECT DISTINCT I.Itemcode, I.Itemtype, I.Descr, I.Category
FROM Item I
INNER JOIN Retailstock RS ON I.Itemcode = RS.Itemcode
INNER JOIN Purchasebill PB ON RS.Roid = PB.Roid AND I.Itemcode = PB.Itemcode


#colass94
SELECT ITEMCODE, ITEMTYPE, DESCR, CATEGORY FROM ITEM WHERE ITEMCODE = (SELECT DISTINCT ITEMCODE FROM QUOTATION WHERE QUOTEDPRICE = (SELECT MIN(QUOTEDPRICE) FROM QUOTATION WHERE QSTATUS='Rejected'))

#colass95
SELECT ITEMCODE, DESCR FROM ITEM WHERE ITEMCODE IN 
	(
	  SELECT DISTINCT ITEMCODE FROM QUOTATION WHERE QUOTEDPRICE = 
		(
		  SELECT MAX(QUOTEDPRICE) FROM QUOTATION WHERE QSTATUS IN ('Rejected','Closed')
		) 
	  AND QSTATUS IN ('Rejected','Closed')
	)


#colass96
SELECT ITEMCODE, DESCR, PRICE FROM ITEM WHERE PRICE = 
	(
	  SELECT MAX(PRICE) FROM ITEM  WHERE PRICE<
		(
		  SELECT MAX(PRICE) FROM ITEM
		)
	)		


#ass98
SELECT ENAME, JOB FROM EMP WHERE EMPNO IN
(
 SELECT EMPNO FROM EMPVEHICLE
)


#ass99
SELECT ENAME FROM EMP WHERE SAL=
	(
		SELECT MAX(SAL) FROM EMP
	)


#ass100
SELECT EMPNO, ENAME FROM EMP WHERE EMPNO IN (
SELECT EV1.EMPNO FROM EMPVEHICLE EV1, EMPVEHICLE EV2 WHERE EV1.VEHICLEID=EV2.VEHICLEID AND 
EV1.EMPNO<>EV2.EMPNO
GROUP BY EV1.EMPNO
)


#ass102
SELECT I.ITEMCODE, I.DESCR, Q.QDATE 
FROM ITEM I, QUOTATION Q
WHERE I.ITEMCODE=Q.ITEMCODE
AND Q.QUOTEDPRICE <
(
  SELECT MAX(QUOTEDPRICE) FROM QUOTATION Q1
  WHERE Q1.QDATE=Q.QDATE
  AND Q1.QUOTATIONID<>Q.QUOTATIONID
)


#ass103
SELECT P.BILLID, P.ITEMCODE 
FROM PURCHASEBILL P
WHERE P.BILLAMOUNT<=
(
SELECT AVG(P1.BILLAMOUNT)
FROM PURCHASEBILL P1
WHERE P1.ROID=P.ROID
GROUP BY ROID
)


#ass104
